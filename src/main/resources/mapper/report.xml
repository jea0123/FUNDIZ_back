<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.funding.mapper.ReportMapper">

    <select id="reportList" resultType="report">
        SELECT * FROM
        (SELECT sub.*, ROWNUM rnum FROM (
        SELECT * FROM report order by REPORTID desc
        ) sub)
    </select>

    <select id="myReportList" resultType="report">
        SELECT * FROM
        (SELECT sub.*, ROWNUM rnum FROM (
        SELECT * FROM report WHERE USERID = #{userId} order by REPORTID desc
        ) sub)
    </select>

    <select id="reportDetail" resultType="report">
        SELECT * FROM report
        WHERE REPORTID = #{reportId}
    </select>

    <select id="item" resultType="report">
        SELECT * FROM report
        WHERE REPORTID = #{reportId}
    </select>

    <insert id="addReport">
        <selectKey keyProperty="reportId" resultType="Long" order="BEFORE">
            SELECT REPORT_SEQ.NEXTVAL FROM DUAL
        </selectKey>

        INSERT INTO report (REPORTID, USERID, TARGET, REASON, REPORTDATE, REPORTSTATUS, REPORTTYPE)
        VALUES (report_seq.NEXTVAL, #{userId}, #{target}, #{reason}, SYSDATE, 'RECEIVED', #{reportType})
    </insert>

</mapper>
